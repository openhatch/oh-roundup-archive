<!-- dollarId: issue.item,v 1.4 2001/08/03 01:19:43 richard Exp dollar-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>
Issue 616: Uploading tarball created on a mac does not allow for dot underscore files - Roundup issue tracker

</title>
<link rel="stylesheet" type="text/css" href="@@file/style.css">
<meta http-equiv="Content-Type"
      content="text/html; charset=utf-8" />

<script type="text/javascript">
submitted = false;
function submit_once() {
    if (submitted) {
        alert("Your request is being processed.\nPlease be patient.");
        event.returnValue = 0;    // work-around for IE
        return 0;
    }
    submitted = true;
    return 1;
}

function help_window(helpurl, width, height) {
    HelpWin = window.open('https://openhatch.org/bugs/' + helpurl, 'RoundupHelpWindow', 'scrollbars=yes,resizable=yes,toolbar=no,height='+height+',width='+width);
}
</script>



</head>
<body class="body">

<table class="body">

<tr>
 <td class="page-header-left"><a href="/" title="OpenHatch"><img src="/static/images/the-logo-bluegreen-87px.png" width="87" height="60" alt="openhatch" /></a></td>
 <td class="page-header-top">
   <div id="body-title">
     <h2>
 
 
 Issue616
 
</h2>
   </div>
   <div id="searchbox">
     <form method="GET" action="issue">
       <input type="hidden" name="@columns"
              value="id,activity,title,creator,assignedto,status,milestone" />
       <input type="hidden" name="@sort" value="activity" />
       <input type="hidden" name="@group" value="priority" />
       <input id="search-text" name="@search_text" size="10" />
       <input type="submit" id="submit" name="submit"
              value="Search" />
     </form>
  </div>
 </td>
</tr>

<tr>
 <td rowspan="2" valign="top" class="sidebar">
  

  <p class="classblock">
    <b>This month: 0.13.10</b><br>
    <a href="/wiki/0.13.10">Goals (in wiki)</a><br>
    <a href="milestone19?@template=open">Bug list</a>
  </p>

  <form method="POST" action="https://openhatch.org/bugs/">
   <p class="classblock">
    <b>Issues</b><br>
    
    <a href="issue?status=-1,1,2,3,4,5,6,7,9,10&amp;@sort=-activity&amp;@search_text=&amp;@columns=id,activity,title,creator,status,milestone&amp;assignedto=-1&amp;@group=priority&amp;@dispname=Show Unassigned&amp;@filter=status,assignedto&amp;@pagesize=50&amp;@startwith=0">Show Unassigned</a><br>
    <a href="issue?status=-1,1,2,3,4,5,6,7,9,10&amp;@sort=-activity&amp;@search_text=&amp;@dispname=Show All&amp;@filter=status&amp;@group=priority&amp;@columns=id,activity,title,creator,assignedto,status,milestone&amp;@pagesize=50&amp;@startwith=0">Show All</a><br>
    <a href="issue?status=-1,1,2,3,4,5,6,7,9,10&amp;@sort=-activity&amp;@search_text=&amp;@columns=id,activity,title,creator,assignedto,status,milestone&amp;@dispname=Show Bitesized&amp;keyword=1&amp;@group=priority&amp;@filter=status,keyword&amp;@pagesize=50&amp;@startwith=0">Show Bitesized</a><br>
    <a href="issue?@template=search">Search</a><br>
    <input type="submit" class="form-small"
           value="Show issue:"><input class="form-small" size="4" type="text" name="@number">
    <input type="hidden" name="@type" value="issue">
    <input type="hidden" name="@action" value="show">
   </p>
  </form>

  

  

  

   <p class="userblock">
    <b>Login</b><br>
    <a href="https://openhatch.org/account/login/?next=/bugs/issue616">Click here to login.</a>
   </p>

  
  <p class="userblock">
   <b>Help</b><br>
   <a href="http://www.roundup-tracker.org/docs.html">Bug tracker docs</a>
  </p>
 </td>
 <td>
  
  
 </td>
</tr>
<tr>
 <td class="content">





<div>

<form method="POST" name="itemSynopsis"
      onsubmit="return submit_once()"
      enctype="multipart/form-data" action="issue616">

<table class="form">
<tr>
 <th class="required">Title</th>
 <td colspan="3">Uploading tarball created on a mac does not allow for dot underscore files</td>
</tr>

<tr>
 <th>Milestone</th>
 <td>0.11.12</td>
 <th class="required">Priority</th>
 <td>bug</td>
</tr>

<tr>
 <th>Waiting On</th>
 <td>
  
  
  
 </td>
 <th>Status</th>
 <td>resolved</td>
</tr>

<tr>
 <th>Superseder</th>
 <td>
  
  
  
 </td>
 <th>Nosy List</th>
 <td>
  paulproteus, sicophrenic, viv
  <br>
 </td>
</tr>

<tr>
 <th>Assigned To</th>
 <td>paulproteus</td>
 <th>Keywords</th>
 <td>
  
  
 </td>
</tr>







</table>
</form>



<p>Created on <b>2011-11-17.10:18:22</b> by <b>sicophrenic</b>, last changed <b>2012-01-07.19:39:49</b> by <b>jesstess</b>.</p>

<table class="files">
 <tr><th colspan="5" class="header">Files</th></tr>
 <tr>
  <th>File name</th>
  <th>Uploaded</th>
  <th>Type</th>
  <th>Edit</th>
  <th>Remove</th>
 </tr>
 <tr>
  <td>
   <a href="file439/unnamed">unnamed</a>
  </td>
  <td>
   <span>viv</span>,
   <span>2011-12-22.21:00:27</span>
  </td>
  <td>text/html</td>
  <td>
  </td>
  <td>
   
  </td>
 </tr>
</table>

<table class="messages">
 <tr><th colspan="4" class="header">Messages</th></tr>
 
  <tr>
   <th><a href="msg2839">msg2839 (view)</a></th>
   <th>Author: sicophrenic</th>
   <th>Date: 2011-12-23.07:13:09</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Yep - it does for me!</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2838">msg2838 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-12-22.22:43:42</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>sicophrenic, thanks for the feedback.

I updated <a href="https://openhatch.org/wiki/Tar_hints_for_Mac_OS_X_users">https://openhatch.org/wiki/Tar_hints_for_Mac_OS_X_users</a> -- does that
handle everything now?</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2836">msg2836 (view)</a></th>
   <th>Author: sicophrenic</th>
   <th>Date: 2011-12-22.21:21:41</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>A few things to note:

1) the command to create the tarball with the --exclude option has a problem with it: the correct 
command should be:
tar zcvf myproject-0.1.tar.gz --exclude='._*' myproject-0.1/
(running the current command throws an error and doesn't actually create the tarball)

2) simply using that command to exclude ._* files doesn't complete the job for me. the peculiar thing 
is when i use 'ls -a', none of the ._* files show up. only when i extract the contents of the tarball are 
the ._* files created. with the environment variable COPYFILE_DIABLE=true, however, I am able to 
successfully create a tarball without ._* files</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2835">msg2835 (view)</a></th>
   <th>Author: sicophrenic</th>
   <th>Date: 2011-12-22.21:00:55</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Testing out the fix now.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2834">msg2834 (view)</a></th>
   <th>Author: viv</th>
   <th>Date: 2011-12-22.21:00:27</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>I will able to check that tonight..

On Thu, Dec 22, 2011 at 12:37 PM, Asheesh Laroia &lt;<a href="mailto:bugs@openhatch.org">bugs@openhatch.org</a>&gt; wrote:

&gt;
&gt; Asheesh Laroia &lt;<a href="mailto:asheesh@asheesh.org">asheesh@asheesh.org</a>&gt; added the comment:
&gt;
&gt; I deployed a fix for this that points users to that wiki page. I tested
&gt; that it
&gt; when I create a tarball with ._ files in it, the special error message
&gt; shows up.
&gt;
&gt; I don't actually have a Mac, so I'd appreciate confirmation from someone
&gt; that
&gt; this detection code is working propeerly. sicophrenic, can you (or someone
&gt; else
&gt; who sees this) test it also and report back? I'll mark as need-review
&gt; until some
&gt; non-me person can validate that it is fixed.
&gt;
&gt; ----------
&gt; status: chatting -&gt; need-review
&gt;
&gt; __________________________________________
&gt; Roundup issue tracker &lt;<a href="mailto:bugs@openhatch.org">bugs@openhatch.org</a>&gt;
&gt; &lt;<a href="https://openhatch.org/bugs/issue616">https://openhatch.org/bugs/issue616</a>&gt;
&gt; __________________________________________
&gt; _______________________________________________
&gt; Devel mailing list
&gt; <a href="mailto:Devel@lists.openhatch.org">Devel@lists.openhatch.org</a>
&gt; <a href="http://lists.openhatch.org/mailman/listinfo/devel">http://lists.openhatch.org/mailman/listinfo/devel</a>
&gt;</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2833">msg2833 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-12-22.20:37:04</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>I deployed a fix for this that points users to that wiki page. I tested that it
when I create a tarball with ._ files in it, the special error message shows up.

I don't actually have a Mac, so I'd appreciate confirmation from someone that
this detection code is working propeerly. sicophrenic, can you (or someone else
who sees this) test it also and report back? I'll mark as need-review until some
non-me person can validate that it is fixed.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2827">msg2827 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-12-16.20:36:41</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>I wrote up a wiki page for this:
<a href="https://openhatch.org/wiki/Tar_hints_for_Mac_OS_X_users">https://openhatch.org/wiki/Tar_hints_for_Mac_OS_X_users</a>

Next I will modify the validation so that it points people at that link.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2825">msg2825 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-12-15.20:08:37</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Thanks for testing this out!

Given the choices, which are:

* Accept tar files that have this dot junk in them
* Ask users to set an environment variable
* Ask users to pass arguments to tar

I prefer the final one. So Bill, I think what I will do is see if I can 
cook up arguments to "tar" that make it exclude these files, and then in 
tar file validation, if your tar file has the special dot stuff, we'll 
present a Mac-specific message saying what options to pass to "tar".

Bill, can you submit the tar files you generated onto this bug so I can 
test with them?

In the next day I'll push a fix that does the above stuff, and Bill maybe 
you can confirm/deny that the instructions are reasonable?</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2824">msg2824 (view)</a></th>
   <th>Author: billputer</th>
   <th>Date: 2011-12-14.22:19:19</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>I've found a way to disable ._ files being included in tar from this blog: 
<a href="http://norman.walsh.name/2008/02/22/tar">http://norman.walsh.name/2008/02/22/tar</a>

OS 10.4 and after: export COPYFILE_DISABLE=true;
OS 10.3 and before: export COPY_EXTENDED_ATTRIBUTES_DISABLE=true;

We could instruct users to add this to their .bashrc.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2822">msg2822 (view)</a></th>
   <th>Author: billputer</th>
   <th>Date: 2011-12-14.21:48:26</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>It looks like the ._ file are created when a file is saved by a Mac OS X application. They don't appear 
when I save a file with vim, but when I save a file with TextMate, the ._ file appears.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2821">msg2821 (view)</a></th>
   <th>Author: billputer</th>
   <th>Date: 2011-12-14.21:43:39</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>I managed to accidentally delete the following message from sicophrenic. Whoops! 
<a href="https://openhatch.org/bugs/msg2717">https://openhatch.org/bugs/msg2717</a>
"Inherently Mac OS X adds ._ files to a tar using the regular command tar zcvf as hinted for the final 
step of the Tar Mission. The check on the uploaded tarball does not account for: myproject-
0.1/._hello.c or myproject-0.1/._Makefile"</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2820">msg2820 (view)</a></th>
   <th>Author: billputer</th>
   <th>Date: 2011-12-14.21:42:00</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>I'm able to reproduce this. The tar command is including ._ files on OS X 10.6.8 (Intel). These are 
known as "resource forks". There's more info here: <a href="http://support.apple.com/kb/TA20578">http://support.apple.com/kb/TA20578</a>

I've attempted to use dot_clean to remove the resource forks, unfortunately, it doesn't seem to 
remove the files, even when I use the "-m Always delete dot underbar files." argument.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2817">msg2817 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-12-14.20:12:32</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>As an update: I just tried to reproduce the problem on a PPC mac by using "curl"
to do the downloading. When I tar up the resulting directory, I get no ._ files.

Maybe the ._ files are only made when one uses a web browser to download the files?

I have seen this problem, so I am sure it is real; it will be helpful to get a
clear way to reproduce it so we can be sure it is fixed when we think it is.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2814">msg2814 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-12-14.17:55:19</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>It looks like one easy fix is as follows:

* Retain the current validation code
* If we detect ._ files, then ask the user to please run dot_clean

Info on dot_clean:
<a href="http://lifehacker.com/377011/delete-mac-system-files-with-dotclean">http://lifehacker.com/377011/delete-mac-system-files-with-dotclean</a>

It's only available on Mac OS 10.5 or later, but I think that's okay.

Then we can keep the high standard of correctness while still being helpful.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg2718">msg2718 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-11-17.13:46:30</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>So I'm not quite sure what we should do in this situation.

We could tell you how to pass arguments to "tar" that make sure these 
files don't show up. But that seems a bit complex for this stage of 
learning.

We could accept them, but then we'd be teaching people that it is okay to 
distribute tarballs with this stuff in it, which isn't quite the right 
thing to teach people, either.

Wondering what others think,

-- Asheesh.</pre>
   </td>
  </tr>
 
</table>

<table class="history"><tr><th colspan="4" class="header">
History
</th></tr><tr>
<th>Date</th>
<th>User</th>
<th>Action</th>
<th>Args</th>
</tr>
<tr><td>2012-01-07&nbsp;19:39:49</td><td>jesstess</td><td>set</td><td>status: need-review -> resolved</td></tr>
<tr><td>2011-12-23&nbsp;07:13:10</td><td>sicophrenic</td><td>set</td><td>messages:
  + <a href="msg2839">msg2839</a></td></tr>
<tr><td>2011-12-22&nbsp;22:43:43</td><td>paulproteus</td><td>set</td><td>nosy:
  + <a href="user79">viv</a><br />messages:
  + <a href="msg2838">msg2838</a></td></tr>
<tr><td>2011-12-22&nbsp;21:21:44</td><td>sicophrenic</td><td>set</td><td>messages:
  + <a href="msg2836">msg2836</a></td></tr>
<tr><td>2011-12-22&nbsp;21:00:57</td><td>sicophrenic</td><td>set</td><td>messages:
  + <a href="msg2835">msg2835</a></td></tr>
<tr><td>2011-12-22&nbsp;21:00:52</td><td>viv</td><td>set</td><td>files:
  + <a href="file439">unnamed</a><br />messages:
  + <a href="msg2834">msg2834</a></td></tr>
<tr><td>2011-12-22&nbsp;20:37:08</td><td>paulproteus</td><td>set</td><td>status: chatting -> need-review<br />messages:
  + <a href="msg2833">msg2833</a></td></tr>
<tr><td>2011-12-16&nbsp;20:36:41</td><td>paulproteus</td><td>set</td><td>assignedto: <a href="user3">paulproteus</a><br />messages:
  + <a href="msg2827">msg2827</a></td></tr>
<tr><td>2011-12-15&nbsp;20:08:43</td><td>paulproteus</td><td>set</td><td>messages:
  + <a href="msg2825">msg2825</a></td></tr>
<tr><td>2011-12-14&nbsp;22:19:23</td><td>billputer</td><td>set</td><td>messages:
  + <a href="msg2824">msg2824</a></td></tr>
<tr><td>2011-12-14&nbsp;21:48:30</td><td>billputer</td><td>set</td><td>messages:
  + <a href="msg2822">msg2822</a></td></tr>
<tr><td>2011-12-14&nbsp;21:43:41</td><td>billputer</td><td>set</td><td>messages:
  + <a href="msg2821">msg2821</a></td></tr>
<tr><td>2011-12-14&nbsp;21:42:05</td><td>billputer</td><td>set</td><td>messages:
  + <a href="msg2820">msg2820</a></td></tr>
<tr><td>2011-12-14&nbsp;21:24:03</td><td>billputer</td><td>set</td><td>messages:
  - <a href="msg2717">msg2717</a></td></tr>
<tr><td>2011-12-14&nbsp;20:12:37</td><td>paulproteus</td><td>set</td><td>messages:
  + <a href="msg2817">msg2817</a></td></tr>
<tr><td>2011-12-14&nbsp;17:55:26</td><td>paulproteus</td><td>set</td><td>messages:
  + <a href="msg2814">msg2814</a></td></tr>
<tr><td>2011-12-14&nbsp;00:08:27</td><td>aldeka</td><td>set</td><td>milestone: <a href="milestone14">0.11.12</a></td></tr>
<tr><td>2011-11-17&nbsp;13:46:31</td><td>paulproteus</td><td>set</td><td>status: unread -> chatting<br />messages:
  + <a href="msg2718">msg2718</a></td></tr>
<tr><td>2011-11-17&nbsp;10:18:22</td><td>sicophrenic</td><td>create</td><td></td></tr>
</table>

</div>

</td>
</tr>

</table>



</body>
</html>

<!-- SHA: cef943195fefd743431d22c020eef27edd6255e1 -->
