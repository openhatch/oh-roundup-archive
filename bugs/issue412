<!-- dollarId: issue.item,v 1.4 2001/08/03 01:19:43 richard Exp dollar-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>
Issue 412: Git training mission repository should use "git am" to apply the patch (but does not) - Roundup issue tracker

</title>
<link rel="stylesheet" type="text/css" href="@@file/style.css">
<meta http-equiv="Content-Type"
      content="text/html; charset=utf-8" />

<script type="text/javascript">
submitted = false;
function submit_once() {
    if (submitted) {
        alert("Your request is being processed.\nPlease be patient.");
        event.returnValue = 0;    // work-around for IE
        return 0;
    }
    submitted = true;
    return 1;
}

function help_window(helpurl, width, height) {
    HelpWin = window.open('https://openhatch.org/bugs/' + helpurl, 'RoundupHelpWindow', 'scrollbars=yes,resizable=yes,toolbar=no,height='+height+',width='+width);
}
</script>



</head>
<body class="body">

<table class="body">

<tr>
 <td class="page-header-left"><a href="/" title="OpenHatch"><img src="/static/images/the-logo-bluegreen-87px.png" width="87" height="60" alt="openhatch" /></a></td>
 <td class="page-header-top">
   <div id="body-title">
     <h2>
 
 
 Issue412
 
</h2>
   </div>
   <div id="searchbox">
     <form method="GET" action="issue">
       <input type="hidden" name="@columns"
              value="id,activity,title,creator,assignedto,status,milestone" />
       <input type="hidden" name="@sort" value="activity" />
       <input type="hidden" name="@group" value="priority" />
       <input id="search-text" name="@search_text" size="10" />
       <input type="submit" id="submit" name="submit"
              value="Search" />
     </form>
  </div>
 </td>
</tr>

<tr>
 <td rowspan="2" valign="top" class="sidebar">
  

  <p class="classblock">
    <b>This month: 0.13.10</b><br>
    <a href="/wiki/0.13.10">Goals (in wiki)</a><br>
    <a href="milestone19?@template=open">Bug list</a>
  </p>

  <form method="POST" action="https://openhatch.org/bugs/">
   <p class="classblock">
    <b>Issues</b><br>
    
    <a href="issue?status=-1,1,2,3,4,5,6,7,9,10&amp;@sort=-activity&amp;@search_text=&amp;@columns=id,activity,title,creator,status,milestone&amp;assignedto=-1&amp;@group=priority&amp;@dispname=Show Unassigned&amp;@filter=status,assignedto&amp;@pagesize=50&amp;@startwith=0">Show Unassigned</a><br>
    <a href="issue?status=-1,1,2,3,4,5,6,7,9,10&amp;@sort=-activity&amp;@search_text=&amp;@dispname=Show All&amp;@filter=status&amp;@group=priority&amp;@columns=id,activity,title,creator,assignedto,status,milestone&amp;@pagesize=50&amp;@startwith=0">Show All</a><br>
    <a href="issue?status=-1,1,2,3,4,5,6,7,9,10&amp;@sort=-activity&amp;@search_text=&amp;@columns=id,activity,title,creator,assignedto,status,milestone&amp;@dispname=Show Bitesized&amp;keyword=1&amp;@group=priority&amp;@filter=status,keyword&amp;@pagesize=50&amp;@startwith=0">Show Bitesized</a><br>
    <a href="issue?@template=search">Search</a><br>
    <input type="submit" class="form-small"
           value="Show issue:"><input class="form-small" size="4" type="text" name="@number">
    <input type="hidden" name="@type" value="issue">
    <input type="hidden" name="@action" value="show">
   </p>
  </form>

  

  

  

   <p class="userblock">
    <b>Login</b><br>
    <a href="https://openhatch.org/account/login/?next=/bugs/issue412">Click here to login.</a>
   </p>

  
  <p class="userblock">
   <b>Help</b><br>
   <a href="http://www.roundup-tracker.org/docs.html">Bug tracker docs</a>
  </p>
 </td>
 <td>
  
  
 </td>
</tr>
<tr>
 <td class="content">





<div>

<form method="POST" name="itemSynopsis"
      onsubmit="return submit_once()"
      enctype="multipart/form-data" action="issue412">

<table class="form">
<tr>
 <th class="required">Title</th>
 <td colspan="3">Git training mission repository should use "git am" to apply the patch (but does not)</td>
</tr>

<tr>
 <th>Milestone</th>
 <td>0.11.05</td>
 <th class="required">Priority</th>
 <td>bug</td>
</tr>

<tr>
 <th>Waiting On</th>
 <td>
  
  
  
 </td>
 <th>Status</th>
 <td>resolved</td>
</tr>

<tr>
 <th>Superseder</th>
 <td>
  
  
  
 </td>
 <th>Nosy List</th>
 <td>
  palhmbs, paulproteus
  <br>
 </td>
</tr>

<tr>
 <th>Assigned To</th>
 <td>palhmbs</td>
 <th>Keywords</th>
 <td>
  
  
 </td>
</tr>







</table>
</form>



<p>Created on <b>2011-05-01.08:43:51</b> by <b>paulproteus</b>, last changed <b>2011-06-01.02:06:43</b> by <b>paulproteus</b>.</p>

<table class="files">
 <tr><th colspan="5" class="header">Files</th></tr>
 <tr>
  <th>File name</th>
  <th>Uploaded</th>
  <th>Type</th>
  <th>Edit</th>
  <th>Remove</th>
 </tr>
 <tr>
  <td>
   <a href="file293/0001-Git-commit-author3.patch">0001-Git-commit-author3.patch</a>
  </td>
  <td>
   <span>palhmbs</span>,
   <span>2011-05-29.09:40:31</span>
  </td>
  <td>application/octet-stream</td>
  <td>
  </td>
  <td>
   
  </td>
 </tr>
 <tr>
  <td>
   <a href="file302/0001-Git-diff-patch-tests.patch">0001-Git-diff-patch-tests.patch</a>
  </td>
  <td>
   <span>palhmbs</span>,
   <span>2011-05-31.19:24:35</span>
  </td>
  <td>application/octet-stream</td>
  <td>
  </td>
  <td>
   
  </td>
 </tr>
</table>

<table class="messages">
 <tr><th colspan="4" class="header">Messages</th></tr>
 
  <tr>
   <th><a href="msg1979">msg1979 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-06-01.02:06:43</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>This is live now. Very exciting.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1969">msg1969 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-05-31.19:56:48</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>I still think that the "!= 1" is confusing. I've replaced it with "== 0" instead.

Other than that, I like these! Pushed to origin/master; once Hudson says they're
good, I'll deploy.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1968">msg1968 (view)</a></th>
   <th>Author: palhmbs</th>
   <th>Date: 2011-05-31.19:24:35</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Done. You should be fine with applying 0001-Git-Commit-author3.patch first then the 0001-Git-diff-
patch-tests.patch. At least that was the order I created them. ;-)</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1966">msg1966 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-05-31.17:09:29</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Paul,

There are a lot of files here. Can you delete the ones that no longer need
review, and then tell me which ones to apply, in which order?</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1959">msg1959 (view)</a></th>
   <th>Author: palhmbs</th>
   <th>Date: 2011-05-31.00:37:56</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>A modified test.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1958">msg1958 (view)</a></th>
   <th>Author: palhmbs</th>
   <th>Date: 2011-05-30.20:44:58</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Your concern seems unfounded, as
if commit_diff.returncode != 1: == is checking whether the returncode is not 1  -- bd

I'll try changing the def test_do_diff_mission_correctly(self): &amp; def 
test_do_diff_mission_incorrectly(self): tests in any case.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1950">msg1950 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-05-29.12:37:53</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Paul,

This is some complex functionality, so we should wrap it in tests. I'm glad 
you're convinced the implementation works. Can you write up a quick test that 
shows that? I'm concerned by you checking the returncode being 1; usually for 
command line apps, 1 indicates an error.

It should be easy enough to do write that test; just call the controller class 
directly, passing it input.

This is good work so far; thank you for getting it this far.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1946">msg1946 (view)</a></th>
   <th>Author: palhmbs</th>
   <th>Date: 2011-05-29.08:59:11</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Ok, I think I've mastered this. - Please review!</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1902">msg1902 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-05-27.16:42:57</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Just a few things that should get cleaned up here:

* You seem to be adding a commented-out line. That's usually not a good idea. If
the line should get removed, just remove it.

* You should check that the exist status of "git am" is zero.

* You don't need the extra quotation marks in the final call to "git commit". To
be precise, do this:

subprocess.Popen(['git', 'commit', '--allow-empty', '-m', commit_msg],
cwd=repo.repo_path)

instead of

subprocess.Popen(['git', 'commit', '--allow-empty', '-m', '"' + commit_msg +
'"'], cwd=repo.repo_path)

(The great thing about the subprocess module is that it handles all the escaping
for you. Adding quotation marks there, therefore, will add them literally to the
data that we use as the commit log message. By the way, this is a *totally super
awesome* thing about subprocess, that we can relax and not worry about escaping.
Life is grand when we have good tools.)

You're on the right track. Thanks for getting this far.! Can you fix those
things and resubmit it?</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1897">msg1897 (view)</a></th>
   <th>Author: palhmbs</th>
   <th>Date: 2011-05-26.11:05:42</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Ok, now we are submitting the users diff output through to git am
and then adding a commit message over the top.

Please review!</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1825">msg1825 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-05-04.14:55:53</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>But that's not a proper simulation of what happens with a real project, because 
in a real project, the user's git configuration chooses what name and email 
address shows up.

I think we should really use 'git am' unless you can simulate it in another way 
that works just as well.

If we go the 'git am' route, we'll need to pass the user's input to 'git am' in 
that case. We can do that with subprocess module. If you need help with it, just 
ask.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1808">msg1808 (view)</a></th>
   <th>Author: palhmbs</th>
   <th>Date: 2011-05-02.02:58:33</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Attached is a patch that should resolve this issue.
Since the openhatch users name will now appear in the git log.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1805">msg1805 (view)</a></th>
   <th>Author: palhmbs</th>
   <th>Date: 2011-05-01.23:04:11</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Let's just change the commit with --author="openhatch username 
&lt;<a href="mailto:username@openhatch.org">username@openhatch.org</a>&gt;" ??</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg1785">msg1785 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2011-05-01.08:43:51</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>The git mission, as it stands right now, has "The Brain" be the author of the 
second commit, even though the user submitted a patch file.

The correct behavior is that the user's patch file guides the author, so the user 
can see (enthusiastically) that his/her name appears in 'git log'.

To fix this, we need to have the mission use 'git am' to apply the patch.

We can add a commit on top with the secret word so that the rest of the code 
doesn't have to change.</pre>
   </td>
  </tr>
 
</table>

<table class="history"><tr><th colspan="4" class="header">
History
</th></tr><tr>
<th>Date</th>
<th>User</th>
<th>Action</th>
<th>Args</th>
</tr>
<tr><td>2011-06-01&nbsp;02:06:43</td><td>paulproteus</td><td>set</td><td>status: need-review -> resolved<br />messages:
  + <a href="msg1979">msg1979</a></td></tr>
<tr><td>2011-05-31&nbsp;19:56:48</td><td>paulproteus</td><td>set</td><td>messages:
  + <a href="msg1969">msg1969</a></td></tr>
<tr><td>2011-05-31&nbsp;19:24:35</td><td>palhmbs</td><td>set</td><td>files:
  + <a href="file302">0001-Git-diff-patch-tests.patch</a><br />messages:
  + <a href="msg1968">msg1968</a></td></tr>
<tr><td>2011-05-31&nbsp;19:23:26</td><td>palhmbs</td><td>set</td><td>files:
  - <a href="file297">0001-Git-diff-patch-tests.py</a></td></tr>
<tr><td>2011-05-31&nbsp;19:21:36</td><td>palhmbs</td><td>set</td><td>files:
  - <a href="file289">0001-Git-commit-author2.patch</a></td></tr>
<tr><td>2011-05-31&nbsp;19:21:31</td><td>palhmbs</td><td>set</td><td>files:
  - <a href="file265">0001-Git-commit-author.patch</a></td></tr>
<tr><td>2011-05-31&nbsp;17:09:29</td><td>paulproteus</td><td>set</td><td>messages:
  + <a href="msg1966">msg1966</a></td></tr>
<tr><td>2011-05-31&nbsp;00:37:56</td><td>palhmbs</td><td>set</td><td>status: in-progress -> need-review<br />files:
  + <a href="file297">0001-Git-diff-patch-tests.py</a><br />messages:
  + <a href="msg1959">msg1959</a></td></tr>
<tr><td>2011-05-30&nbsp;20:44:59</td><td>palhmbs</td><td>set</td><td>messages:
  + <a href="msg1958">msg1958</a></td></tr>
<tr><td>2011-05-29&nbsp;12:37:53</td><td>paulproteus</td><td>set</td><td>status: need-review -> in-progress<br />messages:
  + <a href="msg1950">msg1950</a></td></tr>
<tr><td>2011-05-29&nbsp;09:40:31</td><td>palhmbs</td><td>set</td><td>files:
  + <a href="file293">0001-Git-commit-author3.patch</a></td></tr>
<tr><td>2011-05-29&nbsp;09:40:18</td><td>palhmbs</td><td>set</td><td>files:
  - <a href="file292">0001-Git-commit-author3.patch</a></td></tr>
<tr><td>2011-05-29&nbsp;08:59:12</td><td>palhmbs</td><td>set</td><td>status: in-progress -> need-review<br />files:
  + <a href="file292">0001-Git-commit-author3.patch</a><br />messages:
  + <a href="msg1946">msg1946</a></td></tr>
<tr><td>2011-05-27&nbsp;16:42:58</td><td>paulproteus</td><td>set</td><td>status: need-review -> in-progress<br />messages:
  + <a href="msg1902">msg1902</a></td></tr>
<tr><td>2011-05-26&nbsp;11:05:42</td><td>palhmbs</td><td>set</td><td>status: in-progress -> need-review<br />files:
  + <a href="file289">0001-Git-commit-author2.patch</a><br />messages:
  + <a href="msg1897">msg1897</a></td></tr>
<tr><td>2011-05-04&nbsp;14:55:53</td><td>paulproteus</td><td>set</td><td>status: need-review -> in-progress<br />messages:
  + <a href="msg1825">msg1825</a></td></tr>
<tr><td>2011-05-02&nbsp;05:42:26</td><td>palhmbs</td><td>set</td><td>files:
  + <a href="file265">0001-Git-commit-author.patch</a></td></tr>
<tr><td>2011-05-02&nbsp;05:40:49</td><td>palhmbs</td><td>set</td><td>files:
  - <a href="file264">0001-Git-commit-author3.patch</a></td></tr>
<tr><td>2011-05-02&nbsp;05:19:02</td><td>palhmbs</td><td>set</td><td>files:
  + <a href="file264">0001-Git-commit-author3.patch</a></td></tr>
<tr><td>2011-05-02&nbsp;05:17:49</td><td>palhmbs</td><td>set</td><td>files:
  - <a href="file263">0001-Git-commit-author.patch</a></td></tr>
<tr><td>2011-05-02&nbsp;02:58:33</td><td>palhmbs</td><td>set</td><td>status: in-progress -> need-review<br />files:
  + <a href="file263">0001-Git-commit-author.patch</a><br />messages:
  + <a href="msg1808">msg1808</a></td></tr>
<tr><td>2011-05-02&nbsp;00:15:19</td><td>palhmbs</td><td>set</td><td>status: chatting -> in-progress<br />assignedto: <a href="user42">palhmbs</a></td></tr>
<tr><td>2011-05-01&nbsp;23:04:11</td><td>palhmbs</td><td>set</td><td>status: unread -> chatting<br />messages:
  + <a href="msg1805">msg1805</a></td></tr>
<tr><td>2011-05-01&nbsp;10:15:45</td><td>palhmbs</td><td>set</td><td>nosy:
  + <a href="user42">palhmbs</a><br />milestone: <a href="milestone8">0.11.05</a></td></tr>
<tr><td>2011-05-01&nbsp;08:43:51</td><td>paulproteus</td><td>create</td><td></td></tr>
</table>

</div>

</td>
</tr>

</table>



</body>
</html>

<!-- SHA: cef943195fefd743431d22c020eef27edd6255e1 -->
