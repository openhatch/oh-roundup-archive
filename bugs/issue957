<!-- dollarId: issue.item,v 1.4 2001/08/03 01:19:43 richard Exp dollar-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>
Issue 957: Loading data snapshot for oh-mainline with `manage.py loaddata foo.json.gz` has poor UX - Roundup issue tracker

</title>
<link rel="stylesheet" type="text/css" href="@@file/style.css">
<meta http-equiv="Content-Type"
      content="text/html; charset=utf-8" />

<script type="text/javascript">
submitted = false;
function submit_once() {
    if (submitted) {
        alert("Your request is being processed.\nPlease be patient.");
        event.returnValue = 0;    // work-around for IE
        return 0;
    }
    submitted = true;
    return 1;
}

function help_window(helpurl, width, height) {
    HelpWin = window.open('https://openhatch.org/bugs/' + helpurl, 'RoundupHelpWindow', 'scrollbars=yes,resizable=yes,toolbar=no,height='+height+',width='+width);
}
</script>



</head>
<body class="body">

<table class="body">

<tr>
 <td class="page-header-left"><a href="/" title="OpenHatch"><img src="/static/images/the-logo-bluegreen-87px.png" width="87" height="60" alt="openhatch" /></a></td>
 <td class="page-header-top">
   <div id="body-title">
     <h2>
 
 
 Issue957
 
</h2>
   </div>
   <div id="searchbox">
     <form method="GET" action="issue">
       <input type="hidden" name="@columns"
              value="id,activity,title,creator,assignedto,status,milestone" />
       <input type="hidden" name="@sort" value="activity" />
       <input type="hidden" name="@group" value="priority" />
       <input id="search-text" name="@search_text" size="10" />
       <input type="submit" id="submit" name="submit"
              value="Search" />
     </form>
  </div>
 </td>
</tr>

<tr>
 <td rowspan="2" valign="top" class="sidebar">
  

  <p class="classblock">
    <b>This month: 0.13.10</b><br>
    <a href="/wiki/0.13.10">Goals (in wiki)</a><br>
    <a href="milestone19?@template=open">Bug list</a>
  </p>

  <form method="POST" action="https://openhatch.org/bugs/">
   <p class="classblock">
    <b>Issues</b><br>
    
    <a href="issue?status=-1,1,2,3,4,5,6,7,9,10&amp;@sort=-activity&amp;@search_text=&amp;@columns=id,activity,title,creator,status,milestone&amp;assignedto=-1&amp;@group=priority&amp;@dispname=Show Unassigned&amp;@filter=status,assignedto&amp;@pagesize=50&amp;@startwith=0">Show Unassigned</a><br>
    <a href="issue?status=-1,1,2,3,4,5,6,7,9,10&amp;@sort=-activity&amp;@search_text=&amp;@dispname=Show All&amp;@filter=status&amp;@group=priority&amp;@columns=id,activity,title,creator,assignedto,status,milestone&amp;@pagesize=50&amp;@startwith=0">Show All</a><br>
    <a href="issue?status=-1,1,2,3,4,5,6,7,9,10&amp;@sort=-activity&amp;@search_text=&amp;@columns=id,activity,title,creator,assignedto,status,milestone&amp;@dispname=Show Bitesized&amp;keyword=1&amp;@group=priority&amp;@filter=status,keyword&amp;@pagesize=50&amp;@startwith=0">Show Bitesized</a><br>
    <a href="issue?@template=search">Search</a><br>
    <input type="submit" class="form-small"
           value="Show issue:"><input class="form-small" size="4" type="text" name="@number">
    <input type="hidden" name="@type" value="issue">
    <input type="hidden" name="@action" value="show">
   </p>
  </form>

  

  

  

   <p class="userblock">
    <b>Login</b><br>
    <a href="https://openhatch.org/account/login/?next=/bugs/issue957">Click here to login.</a>
   </p>

  
  <p class="userblock">
   <b>Help</b><br>
   <a href="http://www.roundup-tracker.org/docs.html">Bug tracker docs</a>
  </p>
 </td>
 <td>
  
  
 </td>
</tr>
<tr>
 <td class="content">





<div>

<form method="POST" name="itemSynopsis"
      onsubmit="return submit_once()"
      enctype="multipart/form-data" action="issue957">

<table class="form">
<tr>
 <th class="required">Title</th>
 <td colspan="3">Loading data snapshot for oh-mainline with `manage.py loaddata foo.json.gz` has poor UX</td>
</tr>

<tr>
 <th>Milestone</th>
 <td></td>
 <th class="required">Priority</th>
 <td>bug</td>
</tr>

<tr>
 <th>Waiting On</th>
 <td>
  
  
  
 </td>
 <th>Status</th>
 <td>chatting</td>
</tr>

<tr>
 <th>Superseder</th>
 <td>
  
  
  
 </td>
 <th>Nosy List</th>
 <td>
  ehashman, paulproteus
  <br>
 </td>
</tr>

<tr>
 <th>Assigned To</th>
 <td></td>
 <th>Keywords</th>
 <td>
  bitesize, usability
  
 </td>
</tr>







</table>
</form>



<p>Created on <b>2014-04-16.15:20:31</b> by <b>ehashman</b>, last changed <b>2014-05-05.00:52:14</b> by <b>paulproteus</b>.</p>

<table class="files">
 <tr><th colspan="5" class="header">Files</th></tr>
 <tr>
  <th>File name</th>
  <th>Uploaded</th>
  <th>Type</th>
  <th>Edit</th>
  <th>Remove</th>
 </tr>
 <tr>
  <td>
   <a href="file678/unnamed">unnamed</a>
  </td>
  <td>
   <span>paulproteus</span>,
   <span>2014-05-05.00:52:13</span>
  </td>
  <td>text/html</td>
  <td>
  </td>
  <td>
   
  </td>
 </tr>
</table>

<table class="messages">
 <tr><th colspan="4" class="header">Messages</th></tr>
 
  <tr>
   <th><a href="msg4314">msg4314 (view)</a></th>
   <th>Author: paulproteus</th>
   <th>Date: 2014-05-05.00:52:13</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>loaddata is indeed an upstream thing. So we could file an issue there.

It might be worth profiling it -- where is all the time going? Is it being
spent waiting on the database, or mostly spent parsing the *.json.gz file?
If the parsing, maybe we can find a different format (the Scrapy
"jsonlines" format is one of my favorite formats) and see if we can hack in
support for that.

One great thing about "jsonlines" is that it enables a more useful progress
bar.

If the slowness is in the database calls, maybe we'd better-serve new
contributors by creating a sqlite file that has the data pre-loaded. We
could make that a job in e.g. Jenkins.</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg4313">msg4313 (view)</a></th>
   <th>Author: ehashman</th>
   <th>Date: 2014-05-04.22:58:36</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Doing a very quick investigation, loaddata appears to be a Django thing as
opposed to one of our own scripts. If there's nothing we can do on our end, this
might be a bug to file upstream?!</pre>
   </td>
  </tr>
 
 
  <tr>
   <th><a href="msg4231">msg4231 (view)</a></th>
   <th>Author: ehashman</th>
   <th>Date: 2014-04-16.15:20:30</th>
   <th>
    
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Loading a data snapshot can take up 
to 20 minutes. When I initially 
attempted to load a snapshot, 
following the instructions on the 
wiki, no output was printed in my 
terminal, so I thought that the 
import wasn't working. There was no 
initial "starting import" message, 
and no progress reported. (It 
somewhat resembled a shell utility 
waiting for STDIN.) I learned it was 
working later after I saw python 
using a full core of CPU, and just 
waited it out until it succeeded.

This makes for a rather poor user 
experience. I think the "loaddata" 
command could be improved with a 
little bit of output to the shell: 
first, a message saying the import 
has begun (and it will take a while); 
second, some way of demonstrating 
progress to the user, such as 
printing a '.' every 100 records. An 
update to the wiki warning the user 
the import takes a while would also 
be helpful.</pre>
   </td>
  </tr>
 
</table>

<table class="history"><tr><th colspan="4" class="header">
History
</th></tr><tr>
<th>Date</th>
<th>User</th>
<th>Action</th>
<th>Args</th>
</tr>
<tr><td>2014-05-05&nbsp;00:52:14</td><td>paulproteus</td><td>set</td><td>files:
  + <a href="file678">unnamed</a><br />messages:
  + <a href="msg4314">msg4314</a></td></tr>
<tr><td>2014-05-04&nbsp;22:58:36</td><td>ehashman</td><td>set</td><td>messages:
  + <a href="msg4313">msg4313</a></td></tr>
<tr><td>2014-04-16&nbsp;15:25:11</td><td>ehashman</td><td>set</td><td>priority: feature -> bug</td></tr>
<tr><td>2014-04-16&nbsp;15:20:31</td><td>ehashman</td><td>create</td><td></td></tr>
</table>

</div>

</td>
</tr>

</table>



</body>
</html>

<!-- SHA: cef943195fefd743431d22c020eef27edd6255e1 -->
